<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Getting started with EpiCompare (for SIR agent-based data) • EpiCompare</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Getting started with EpiCompare (for SIR agent-based data)">
<meta property="og:description" content="">
<meta property="og:image" content="/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EpiCompare</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/comparing-bands-and-assessing-containment.html">Comparing bands and assessing containment</a>
    </li>
    <li>
      <a href="../articles/getting-started.html">Getting started with EpiCompare (for SIR agent-based data)</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/skgallagher/EpiCompare">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="getting-started_files/kePrint-0.0.1/kePrint.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Getting started with EpiCompare (for SIR agent-based data)</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/skgallagher/EpiCompare/blob/master/vignettes/getting-started.Rmd"><code>vignettes/getting-started.Rmd</code></a></small>
      <div class="hidden name"><code>getting-started.Rmd</code></div>

    </div>

    
    
<p><left><img src="../man/figures/logo.png" width="100"></left></p>
<div id="installation" class="section level1">
<h1 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h1>
<p>To install <code>EpiCompare</code>, run the folllowing code.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span>(<span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span>(EpiCompare)){
  <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(devtools)
  devtools<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/devtools/man/remote-reexports.html">install_github</a></span>(<span class="st">"skgallagher/EpiCompare"</span>)
}
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(EpiCompare)</code></pre></div>
</div>
<div id="quickstart" class="section level1">
<h1 class="hasAnchor">
<a href="#quickstart" class="anchor"></a>Quickstart</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(ggplot2)
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(dplyr)
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(tidyr)
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(ggtern)</code></pre></div>
<p>This “quickstart” guide presents how to: - work with agent-based SIR data and how to leverage <code>geom_aggregate</code> to quickly compare groups of the population’s experience of the epidemic. - Visualizing and quantifying geometric uncertainty in SIR based data, using <code>agents_to_aggregate</code> to convert data from agents to aggregate, and leveraging <code>geom_prediction_band</code> to express uncertainty and centrality of simulations. This example also gives an example of the internal <code>simulate_SIR_agents</code> function.</p>
<div id="measles-outbreak-in-hagelloch-germany-in-1861" class="section level2">
<h2 class="hasAnchor">
<a href="#measles-outbreak-in-hagelloch-germany-in-1861" class="anchor"></a>Measles outbreak in Hagelloch, Germany in 1861</h2>
<p>Our first example comes from a Measles outbreak in Hagelloch, Germany in 1861. We have data on each child (agent) in the town.The data we use (as seen below) has each child’s information relative to when they were reported to be infected and recovered, information on their school class.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Visualizing epidemic progression using EpiCompare
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(kableExtra)
EpiCompare<span class="op">::</span>hagelloch_raw <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(PN, NAME, AGE, SEX,
         tPRO, tERU, tI, tR) <span class="op">%&gt;%</span>
<span class="st">  </span>knitr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>() <span class="op">%&gt;%</span>
<span class="st">  </span>kableExtra<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span>()</code></pre></div>
<table class="table table">
<thead><tr>
<th style="text-align:right;">
PN
</th>
<th style="text-align:left;">
NAME
</th>
<th style="text-align:right;">
AGE
</th>
<th style="text-align:left;">
SEX
</th>
<th style="text-align:right;">
tPRO
</th>
<th style="text-align:right;">
tERU
</th>
<th style="text-align:right;">
tI
</th>
<th style="text-align:right;">
tR
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Mueller
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:right;">
22.71242
</td>
<td style="text-align:right;">
26.22541
</td>
<td style="text-align:right;">
21.71242
</td>
<td style="text-align:right;">
29.22541
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Mueller
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:right;">
24.21169
</td>
<td style="text-align:right;">
28.79112
</td>
<td style="text-align:right;">
23.21169
</td>
<td style="text-align:right;">
31.79112
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
Mueller
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:right;">
29.59102
</td>
<td style="text-align:right;">
33.69121
</td>
<td style="text-align:right;">
28.59102
</td>
<td style="text-align:right;">
36.69121
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
Seibold
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:left;">
male
</td>
<td style="text-align:right;">
28.11698
</td>
<td style="text-align:right;">
29.02866
</td>
<td style="text-align:right;">
27.11698
</td>
<td style="text-align:right;">
32.02866
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
Motzer
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:right;">
23.05953
</td>
<td style="text-align:right;">
28.41510
</td>
<td style="text-align:right;">
22.05953
</td>
<td style="text-align:right;">
31.41510
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
Motzer
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:left;">
male
</td>
<td style="text-align:right;">
27.95444
</td>
<td style="text-align:right;">
30.23918
</td>
<td style="text-align:right;">
26.95444
</td>
<td style="text-align:right;">
33.23918
</td>
</tr>
</tbody>
</table>
<p>To understand to epidemic we can examine it through an “aggregate” lense (using <code>geom_aggregate</code>), which aggregates across agents to find the number of susceptible, infectious, and recovered, and plots them in the ternary view.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html">theme_set</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span>())

hagelloch_raw <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">y =</span> tI, <span class="dt">z =</span> tR)) <span class="op">+</span>
<span class="st">    </span><span class="kw"><a href="https://rdrr.io/pkg/EpiCompare/man/stat_aggregate.html">geom_aggregate</a></span>() <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw"><a href="https://rdrr.io/pkg/ggtern/man/coord_tern.html">coord_tern</a></span>() <span class="op">+</span>
<span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">x =</span> <span class="st">"S"</span>, <span class="dt">y =</span> <span class="st">"I"</span>, <span class="dt">z =</span> <span class="st">"R"</span>, <span class="dt">title =</span> <span class="st">"Town analysis"</span>)</code></pre></div>
<p><img src="getting-started_files/figure-html/unnamed-chunk-3-1.png" width="700" style="display: block; margin: auto;"></p>
<p>Previous work has suggested that the class (<code>CL</code>) the student was in effected how the experienced the outbreak. The below figure shows differences in the outbreak relative to this grouping.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">hagelloch_raw <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">rename</a></span>(<span class="st">`</span><span class="dt">school grade</span><span class="st">`</span> =<span class="st"> </span>CL) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(<span class="st">`</span><span class="dt">school grade</span><span class="st">`</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span>(<span class="st">`</span><span class="dt">number of students</span><span class="st">`</span> =<span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/n.html">n</a></span>()) <span class="op">%&gt;%</span>
<span class="st">  </span>knitr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>() <span class="op">%&gt;%</span>
<span class="st">  </span>kableExtra<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span>()</code></pre></div>
<table class="table table">
<thead><tr>
<th style="text-align:left;">
school grade
</th>
<th style="text-align:right;">
number of students
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
preschool
</td>
<td style="text-align:right;">
90
</td>
</tr>
<tr>
<td style="text-align:left;">
1st class
</td>
<td style="text-align:right;">
30
</td>
</tr>
<tr>
<td style="text-align:left;">
2nd class
</td>
<td style="text-align:right;">
68
</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">hagelloch_raw <span class="op">%&gt;%</span>
<span class="st">   </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">y =</span> tI, <span class="dt">z =</span> tR, <span class="dt">color =</span> CL)) <span class="op">+</span>
<span class="st">       </span><span class="kw"><a href="https://rdrr.io/pkg/EpiCompare/man/stat_aggregate.html">geom_aggregate</a></span>() <span class="op">+</span><span class="st"> </span>
<span class="st">       </span><span class="kw"><a href="https://rdrr.io/pkg/ggtern/man/coord_tern.html">coord_tern</a></span>() <span class="op">+</span>
<span class="st">       </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">x =</span> <span class="st">"S"</span>, <span class="dt">y =</span> <span class="st">"I"</span>, <span class="dt">z =</span> <span class="st">"R"</span>,
            <span class="dt">color =</span> <span class="st">"School grade"</span>,
            <span class="dt">title =</span> <span class="st">"Town analysis by grade"</span>) <span class="op">+</span>
<span class="st">       </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_color_brewer</a></span>(<span class="dt">type =</span> <span class="st">"qual"</span>)</code></pre></div>
<p><img src="getting-started_files/figure-html/unnamed-chunk-5-1.png" width="700" style="display: block; margin: auto;"></p>
</div>
<div id="agent-sir-simulations-models" class="section level2">
<h2 class="hasAnchor">
<a href="#agent-sir-simulations-models" class="anchor"></a>Agent SIR simulations models</h2>
<div id="simulating-epidemics-with-simulate_sir_agents-" class="section level3">
<h3 class="hasAnchor">
<a href="#simulating-epidemics-with-simulate_sir_agents-" class="anchor"></a>Simulating epidemics with <code>simulate_SIR_agents</code>.</h3>
<p>The below code simulates SIR data at the individual (or agent) level, aggregates it into SIR format, and plots it in the ``standard’’ view of <em>percent in state</em> vs. <em>time</em>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n_sims &lt;-<span class="st"> </span><span class="dv">1</span>
n_time_steps &lt;-<span class="st"> </span><span class="dv">100</span>
beta &lt;-<span class="st"> </span>.<span class="dv">1</span>
gamma &lt;-<span class="st"> </span>.<span class="dv">03</span>
init_SIR &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">950</span>, <span class="dv">50</span>, <span class="dv">0</span>)
    
out &lt;-<span class="st"> </span>EpiCompare<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/EpiCompare/man/simulate_SIR_agents.html">simulate_SIR_agents</a></span>(<span class="dt">n_sims =</span> n_sims,
                                 <span class="dt">n_time_steps =</span> n_time_steps,
                                 <span class="dt">beta =</span> beta, <span class="dt">gamma =</span> gamma,
                                 <span class="dt">init_SIR =</span> init_SIR)
              
df_ave &lt;-<span class="st"> </span>out <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/EpiCompare/man/agents_to_aggregate.html">agents_to_aggregate</a></span>(<span class="dt">states =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(tI, tR)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">rename</a></span>(<span class="dt">S =</span> <span class="st">"X0"</span>, <span class="dt">I =</span> <span class="st">"X1"</span>, <span class="dt">R =</span> <span class="st">"X2"</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(t) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span>(<span class="dt">S =</span> <span class="kw"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(S), <span class="dt">I =</span> <span class="kw"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(I), <span class="dt">R =</span> <span class="kw"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(R))

                   
<span class="cf">if</span> (<span class="kw"><a href="https://rdrr.io/pkg/EpiCompare/man/tidyr_new_interface.html">tidyr_new_interface</a></span>()){ <span class="co"># if tidyr version &gt; 0.8.99</span>
  df_ave_lines &lt;-<span class="st"> </span>df_ave <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span>(<span class="dt">names_to =</span> <span class="st">"State"</span>, 
                                          <span class="dt">values_to =</span> <span class="st">"Value"</span>,
                                          <span class="dt">cols =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(S, I, R))
} <span class="cf">else</span> {
  df_ave_lines &lt;-<span class="st"> </span>df_ave <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://tidyr.tidyverse.org/reference/gather.html">gather</a></span>(<span class="dt">key =</span> <span class="st">"State"</span>, <span class="dt">value =</span> <span class="st">"Value"</span>,
                                S, I, R)
}

<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="dt">data =</span> df_ave_lines,
       <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> t, <span class="dt">y =</span> Value, <span class="dt">group =</span> State, <span class="dt">col =</span> State)) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>()</code></pre></div>
<p><img src="getting-started_files/figure-html/unnamed-chunk-6-1.png" width="60%" style="display: block; margin: auto;"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="dt">data =</span> df_ave_lines,
       <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> t, <span class="dt">y =</span> Value)) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span>(State <span class="op">~</span><span class="st"> </span>.) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>() </code></pre></div>
<p><img src="getting-started_files/figure-html/unnamed-chunk-6-2.png" width="60%" style="display: block; margin: auto;"></p>
<p>We visualize this simulation with a single line in the following way.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="dt">data =</span> df_ave, <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> S, <span class="dt">y =</span> I, <span class="dt">z =</span> R)) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_path</a></span>() <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/ggtern/man/coord_tern.html">coord_tern</a></span>()</code></pre></div>
<p><img src="getting-started_files/figure-html/unnamed-chunk-7-1.png" width="700" style="display: block; margin: auto;"></p>
</div>
<div id="simulating-and-visualizing-multiple-epidemics" class="section level3">
<h3 class="hasAnchor">
<a href="#simulating-and-visualizing-multiple-epidemics" class="anchor"></a>Simulating and visualizing multiple epidemics</h3>
<p>We can also simulation multiple epidemics with different parameters (and can also examine simulations from both <code>pomp</code> and <code>epiModels</code> packages).</p>
<p>Using the same simulation parameters above we can simulate 50 epidemics:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n_sims &lt;-<span class="st"> </span><span class="dv">50</span> <span class="co"># only code changed</span>
n_time_steps &lt;-<span class="st"> </span><span class="dv">100</span>
beta &lt;-<span class="st"> </span>.<span class="dv">1</span>
gamma &lt;-<span class="st"> </span>.<span class="dv">03</span>
init_SIR &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">950</span>, <span class="dv">50</span>, <span class="dv">0</span>)

    
out &lt;-<span class="st"> </span>EpiCompare<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/EpiCompare/man/simulate_SIR_agents.html">simulate_SIR_agents</a></span>(<span class="dt">n_sims =</span> n_sims,
                                 <span class="dt">n_time_steps =</span> n_time_steps,
                                 <span class="dt">beta =</span> beta, <span class="dt">gamma =</span> gamma,
                                 <span class="dt">init_SIR =</span> init_SIR)
          </code></pre></div>
<p>We then use the <code>agents_to_aggregate</code> function to do the same thing (note that it preforms different for <code>grouped_df</code>s and standard <code>data.frame</code>s - as it’s a method):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df_group &lt;-<span class="st"> </span>out <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(sim) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/EpiCompare/man/agents_to_aggregate.html">agents_to_aggregate</a></span>(<span class="dt">states =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"tI"</span>, <span class="st">"tR"</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">rename</a></span>(<span class="dt">S =</span> <span class="st">"X0"</span>, <span class="dt">I =</span> <span class="st">"X1"</span>, <span class="dt">R =</span> <span class="st">"X2"</span>) 


<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(df_group, <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> S, <span class="dt">y =</span> I, <span class="dt">z =</span> R, <span class="dt">group =</span> sim)) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_path</a></span>(<span class="dt">alpha =</span> .<span class="dv">1</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/ggtern/man/coord_tern.html">coord_tern</a></span>()</code></pre></div>
<p><img src="getting-started_files/figure-html/unnamed-chunk-9-1.png" width="700" style="display: block; margin: auto;"></p>
<p>What’s more if we want to compare the original simulation with these new simulations (and see how well they match) we can do the following:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_path</a></span>(<span class="dt">data =</span> df_ave, <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> S, <span class="dt">y =</span> I, <span class="dt">z =</span> R)) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_path</a></span>(<span class="dt">data =</span> df_group, <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> S, <span class="dt">y =</span> I, <span class="dt">z =</span> R, <span class="dt">group =</span> sim),
       <span class="dt">alpha =</span> .<span class="dv">1</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/ggtern/man/coord_tern.html">coord_tern</a></span>() 
<span class="co">#&gt; Warning: Ignoring unknown aesthetics: z</span>

<span class="co">#&gt; Warning: Ignoring unknown aesthetics: z</span></code></pre></div>
<p><img src="getting-started_files/figure-html/unnamed-chunk-10-1.png" width="700" style="display: block; margin: auto;"></p>
<p>How extreme is the first simulation compared to the rest? Let’s create a empirical 95% prediction band from the later simulations.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/EpiCompare/man/geom_prediction_band.html">geom_prediction_band</a></span>(<span class="dt">data =</span> df_group, 
                       <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> S, <span class="dt">y =</span> I, <span class="dt">z =</span> R,
                           <span class="dt">sim_group =</span> <span class="kw"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(sim))),
                       <span class="dt">fill =</span> <span class="st">"blue"</span>, <span class="dt">color =</span> <span class="ot">NA</span>, <span class="dt">alpha =</span> .<span class="dv">2</span>,
                       <span class="dt">conf_level =</span> .<span class="dv">05</span>, <span class="dt">grid_size =</span> <span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="dv">100</span>, <span class="dv">2</span>),
                       <span class="dt">pb_type =</span> <span class="st">"delta_ball"</span>
                       ) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_path</a></span>(<span class="dt">data =</span> df_ave, <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> S, <span class="dt">y =</span> I, <span class="dt">z =</span> R)) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/ggtern/man/coord_tern.html">coord_tern</a></span>() 
<span class="co">#&gt; Warning: Ignoring unknown aesthetics: z</span></code></pre></div>
<p><img src="getting-started_files/figure-html/unnamed-chunk-11-1.png" width="700" style="display: block; margin: auto;"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># note: the error message actually comes from the geom_path</span></code></pre></div>
<p>Here’s a demo of all current geometric tools to create prediction bands:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vis_data &lt;-<span class="st"> </span>EpiCompare<span class="op">::</span>pomp_df <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">rename</a></span>(<span class="dt">x =</span> <span class="st">"S"</span>, <span class="dt">y =</span> <span class="st">"I"</span>, <span class="dt">z =</span> <span class="st">"R"</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> x, <span class="dt">y =</span>y, <span class="dt">z =</span> z, <span class="dt">group =</span> .id)) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_path</a></span>(<span class="dt">alpha =</span> .<span class="dv">03</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/ggtern/man/coord_tern.html">coord_tern</a></span>() <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">title =</span> <span class="st">"Actually data paths"</span>)

vis_spherical &lt;-<span class="st"> </span>EpiCompare<span class="op">::</span>pomp_df <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">rename</a></span>(<span class="dt">x =</span> <span class="st">"S"</span>, <span class="dt">y =</span> <span class="st">"I"</span>, <span class="dt">z =</span> <span class="st">"R"</span>, <span class="dt">t =</span> <span class="st">"time"</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">z =</span> z, <span class="dt">t =</span> t)) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/EpiCompare/man/geom_prediction_band.html">geom_prediction_band</a></span>(<span class="dt">pb_type =</span> <span class="st">"spherical_ball"</span>,
                       <span class="dt">grid_size =</span> <span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="dv">100</span>,<span class="dv">2</span>),
                       <span class="dt">conf_level =</span> .<span class="dv">95</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/ggtern/man/coord_tern.html">coord_tern</a></span>() <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">title =</span> <span class="st">"Spherical CB"</span>)

vis_delta_ball &lt;-<span class="st"> </span>EpiCompare<span class="op">::</span>pomp_df <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">rename</a></span>(<span class="dt">x =</span> <span class="st">"S"</span>, <span class="dt">y =</span> <span class="st">"I"</span>, <span class="dt">z =</span> <span class="st">"R"</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">.id =</span> <span class="kw"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(.id)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">z =</span> z, <span class="dt">sim_group =</span> .id)) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/EpiCompare/man/geom_prediction_band.html">geom_prediction_band</a></span>(<span class="dt">pb_type =</span> <span class="st">"delta_ball"</span>,
                       <span class="dt">grid_size =</span> <span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="dv">100</span>,<span class="dv">2</span>),
                       <span class="dt">conf_level =</span> .<span class="dv">95</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/ggtern/man/coord_tern.html">coord_tern</a></span>() <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">title =</span> <span class="st">"Delta-ball CB"</span>)

vis_kde &lt;-<span class="st"> </span>EpiCompare<span class="op">::</span>pomp_df <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">rename</a></span>(<span class="dt">x =</span> <span class="st">"S"</span>, <span class="dt">y =</span> <span class="st">"I"</span>, <span class="dt">z =</span> <span class="st">"R"</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">.id =</span> <span class="kw"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(.id)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">z =</span> z, <span class="dt">sim_group =</span> .id)) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/EpiCompare/man/geom_prediction_band.html">geom_prediction_band</a></span>(<span class="dt">pb_type =</span> <span class="st">"kde"</span>,
                       <span class="dt">grid_size =</span> <span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="dv">100</span>,<span class="dv">2</span>),
                       <span class="dt">conf_level =</span> .<span class="dv">95</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/ggtern/man/coord_tern.html">coord_tern</a></span>() <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">title =</span> <span class="st">"KDE CB"</span>)

vis_convex_hull &lt;-<span class="st"> </span>EpiCompare<span class="op">::</span>pomp_df <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">rename</a></span>(<span class="dt">x =</span> <span class="st">"S"</span>, <span class="dt">y =</span> <span class="st">"I"</span>, <span class="dt">z =</span> <span class="st">"R"</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">.id =</span> <span class="kw"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(.id)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">z =</span> z, <span class="dt">sim_group =</span> .id)) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/EpiCompare/man/geom_prediction_band.html">geom_prediction_band</a></span>(<span class="dt">pb_type =</span> <span class="st">"convex_hull"</span>,
            <span class="dt">conf_level =</span> .<span class="dv">95</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/ggtern/man/coord_tern.html">coord_tern</a></span>() <span class="op">+</span>
<span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">title =</span> <span class="st">"Convex hull CB"</span>)

<span class="kw"><a href="https://rdrr.io/pkg/ggtern/man/arrangeGrob.html">grid.arrange</a></span>(vis_data, vis_spherical,
             vis_delta_ball, vis_kde,
             vis_convex_hull, <span class="dt">nrow =</span> <span class="dv">2</span>)</code></pre></div>
<p><img src="getting-started_files/figure-html/unnamed-chunk-12-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#installation">Installation</a></li>
      <li>
<a href="#quickstart">Quickstart</a><ul class="nav nav-pills nav-stacked">
<li><a href="#measles-outbreak-in-hagelloch-germany-in-1861">Measles outbreak in Hagelloch, Germany in 1861</a></li>
      <li><a href="#agent-sir-simulations-models">Agent SIR simulations models</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://skgallagher.github.io/">Shannon Gallagher</a>, <a href="https://benjaminleroy.github.io/">Benjamin LeRoy</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
