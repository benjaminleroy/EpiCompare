<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Basic simulations with EpiCompare • EpiCompare</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><meta property="og:title" content="Basic simulations with EpiCompare">
<meta property="og:description" content="EpiCompare">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">EpiCompare</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/not-built-vignettes/hagelloch-eda.html">Hagelloch Measles -- Pre-processing and EDA</a>
    </li>
    <li>
      <a href="../../articles/not-built-vignettes/hagelloch-mods.html">Hagelloch Measles -- Modeling and Simulation</a>
    </li>
    <li>
      <a href="../../articles/not-built-vignettes/hagelloch-sir-fit.html">Hagelloch Measles -- Fitting the deterministic, continuous time SIR model</a>
    </li>
    <li>
      <a href="../../articles/getting-started.html">Getting started</a>
    </li>
    <li>
      <a href="../../articles/not-built-vignettes/ternary-plots-explained.html">An Introduction to Ternary Plots</a>
    </li>
    <li>
      <a href="../../articles/not-built-vignettes/comparing-bands-and-assessing-containment.html">Comparing Models (to Models) and Epidemics (to Models)</a>
    </li>
    <li>
      <a href="../../articles/not-built-vignettes/depths-impact-on-prediction-bands.html">Understanding Prediction Bands and the Impact of Quantile Functions</a>
    </li>
    <li>
      <a href="../../articles/not-built-vignettes/example-epimodel.html">Using EpiModel models with EpiCompare</a>
    </li>
    <li>
      <a href="../../articles/not-built-vignettes/basic-abm.html">Basic simulations with EpiCompare</a>
    </li>
    <li class="divider">
    <li>
      <a href="../../articles/index.html">More...</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/skgallagher/EpiCompare/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="basic-abm_files/header-attrs-2.3/header-attrs.js"></script><script src="basic-abm_files/kePrint-0.0.1/kePrint.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Basic simulations with EpiCompare</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/skgallagher/EpiCompare/blob/master/vignettes/not-built-vignettes/basic-abm.Rmd"><code>vignettes/not-built-vignettes/basic-abm.Rmd</code></a></small>
      <div class="hidden name"><code>basic-abm.Rmd</code></div>

    </div>

    
    
<div id="overview" class="section level2">
<h2 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h2>
<p>In this vignette, we explore agent-based models with EpiCompare. Specifically, we</p>
<ol style="list-style-type: decimal">
<li><p>Define an agent-based model (ABM).</p></li>
<li><p>Briefly explain the relationship between ABMs and aggregate models.</p></li>
<li><p>Demonstrate how EpiCompare can be used to create and visualize basic agent-based models.</p></li>
</ol>
</div>
<div id="what-is-an-agent-based-model" class="section level2">
<h2 class="hasAnchor">
<a href="#what-is-an-agent-based-model" class="anchor"></a>What is an agent-based model?</h2>
</div>
<div id="abms-vs--aggregate-models" class="section level2">
<h2 class="hasAnchor">
<a href="#abms-vs--aggregate-models" class="anchor"></a>ABMs vs. aggregate models</h2>
<p>There are numerous sophisticated software to create stochastic aggregate models (e.g. <span class="citation">(<span class="citeproc-not-found" data-reference-id="pomp2010"><strong>???</strong></span>)</span> or <span class="citation">(Jenness, Goodreau, and Morris 2018)</span>). Over the past decade, the number of ABMs has also increased (e.g. FRED, VBI). In our experience, ABMs are less accessible to the typical scientist because of privacy concerns or computational concerns.</p>
<p>One thing we can do with ABMs is to mimic an aggregate model. While a compartment model would only look at group-level information with respect to an epidemic (e.g. the number of susceptible, infectious, and recovered at each time step), an agent-based model would allow us to track any and all agents over time.</p>
</div>
<div id="using-epicompare-with-basic-abms" class="section level2">
<h2 class="hasAnchor">
<a href="#using-epicompare-with-basic-abms" class="anchor"></a>Using EpiCompare with basic ABMs</h2>
<p>EpiCompare creates stochastic ABMs that are based on the ODEs used to describe transitions among epidemic states. Note that the functions in EpiCompare are based on <strong>discrete</strong> time-steps or difference equations as opposed to ODEs.</p>
<p>Recall that a SIR model without birth and death in a population of size <span class="math inline">\(N\)</span> and initial population <span class="math inline">\((S(0), I(0), R(0))\)</span> is given by the following set of equations:</p>
<p><span class="math display">\[
\frac{dS}{dt} = -\beta \frac{SI}{N}
\]</span></p>
<p><span class="math display">\[
\frac{dI}{dt} = \beta \frac{SI}{N} - \gamma I
\]</span></p>
<p><span class="math display">\[
\frac{dR}{dt} = \gamma I.
\]</span></p>
<p>We could instead use a transition matrix (cite) to describe the <strong>non-negative</strong> number of individuals moving from state <span class="math inline">\(i\)</span> to state <span class="math inline">\(j\)</span> (either the instantaneous rate of change or the difference from one time step to the next).</p>
<p>For example, the SIR ODEs describe <span class="math inline">\(K=3\)</span> states and so our transition matrix is</p>
<p><span class="math display">\[
D = \left (\begin{array}{ccc}
S\left (1 - \beta \frac{I}{N} \right ) &amp; S\beta \frac{I}{N} &amp; 0\\
0 &amp; I(1 - \gamma) &amp; I\gamma\\
0 &amp; 0 &amp; R
\end{array} \right ),
\]</span> where entry (1,2) corresponds to the movement of individuals in state S to state I.</p>
<p>Once we have <span class="math inline">\(D\)</span>, we can create a stochastic analog of the model by deriving a transition probability matrix <span class="math inline">\(P\)</span> where entry <span class="math inline">\(P_{ij} = \frac{D_{ij} }{\sum_{k=1}^K D_{ik}}\)</span> is the normalized probability of moving from the current state (the row) to the next state (the column).</p>
<p>The stochastic updates in the ABM are then given through Multinomial draws conditioned on an agent’s current state at time <span class="math inline">\(t\)</span>. For agent <span class="math inline">\(n\)</span> currently in state <span class="math inline">\(i\)</span>, the agent’s next state is given by a Categorical draw which is dependent on the transition matrix <span class="math inline">\(D\)</span>, <span class="math display">\[
A_n(t+1) |D(t) \sim \mathrm{Categorical} \left (1, P_i(t) \right ).
\]</span></p>
<p>This procedure can be done simply with EpiCompare with the following code:</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">2020</span>)
<span class="co">## This is the SIR representation</span>
<span class="no">trans_mat</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"X0 * (1 - X1 * par1 / N)"</span>, <span class="st">"X0 * X1  * par1 / N"</span>, <span class="st">"0"</span>,
                  <span class="st">"0"</span>, <span class="st">"X1 * (1 - par2)"</span>, <span class="st">"par2 * X1"</span>,
                  <span class="st">"0"</span>, <span class="st">"0"</span>, <span class="st">"X2"</span>), <span class="kw">byrow</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">nrow</span> <span class="kw">=</span> <span class="fl">3</span>)
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">trans_mat</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"S"</span>, <span class="st">"I"</span>, <span class="st">"R"</span>)
<span class="no">init_vals</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">950</span>, <span class="fl">50</span>, <span class="fl">0</span>)
<span class="no">par_vals</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">par1</span> <span class="kw">=</span> <span class="fl">.1</span>, <span class="kw">par2</span> <span class="kw">=</span> <span class="fl">.03</span>)
<span class="no">max_T</span> <span class="kw">&lt;-</span> <span class="fl">100</span>
<span class="no">n_sims</span> <span class="kw">&lt;-</span> <span class="fl">10</span>

<span class="no">abm</span> <span class="kw">&lt;-</span> <span class="fu">simulate_agents</span>(<span class="no">trans_mat</span>,
                       <span class="no">init_vals</span>,
                       <span class="no">par_vals</span>,
                       <span class="no">max_T</span>,
                       <span class="no">n_sims</span>,
                       <span class="kw">verbose</span> <span class="kw">=</span> <span class="fl">FALSE</span>)

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">abm</span>) <span class="kw">%&gt;%</span>
  <span class="fu">kable</span>() <span class="kw">%&gt;%</span> <span class="fu">kable_styling</span>(<span class="kw">position</span> <span class="kw">=</span> <span class="st">"center"</span>)</pre></body></html></div>
<table class="table table">
<thead><tr>
<th style="text-align:right;">
sim
</th>
<th style="text-align:right;">
agent_id
</th>
<th style="text-align:right;">
S
</th>
<th style="text-align:right;">
I
</th>
<th style="text-align:right;">
R
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
42
</td>
<td style="text-align:right;">
52
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
77
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
31
</td>
<td style="text-align:right;">
65
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
60
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
70
</td>
<td style="text-align:right;">
NA
</td>
</tr>
</tbody>
</table>
<p>The main difference in the output of <code>simulate_agents</code> and functions from EpiModel and pomp is that we can determine exactly when each agent moves from one state as opposed to the aggregate total in each state.</p>
<p>We can compare our ABM to aggregate models with <code>agents_to_aggregate</code>.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="no">agg_model</span> <span class="kw">&lt;-</span> <span class="no">abm</span> <span class="kw">%&gt;%</span> <span class="kw pkg">dplyr</span><span class="kw ns">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(<span class="no">sim</span>) <span class="kw">%&gt;%</span>
  <span class="fu">agents_to_aggregate</span>(<span class="kw">states</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">I</span>, <span class="no">R</span>))
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">agg_model</span>) <span class="kw">%&gt;%</span>
      <span class="fu">kable</span>() <span class="kw">%&gt;%</span> <span class="fu">kable_styling</span>(<span class="kw">position</span> <span class="kw">=</span> <span class="st">"center"</span>)</pre></body></html></div>
<table class="table table">
<thead><tr>
<th style="text-align:right;">
sim
</th>
<th style="text-align:right;">
t
</th>
<th style="text-align:right;">
X0
</th>
<th style="text-align:right;">
X1
</th>
<th style="text-align:right;">
X2
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1000
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
950
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
945
</td>
<td style="text-align:right;">
54
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
941
</td>
<td style="text-align:right;">
57
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
936
</td>
<td style="text-align:right;">
62
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
932
</td>
<td style="text-align:right;">
64
</td>
<td style="text-align:right;">
4
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="fu">ggplot</span>(<span class="no">agg_model</span>, <span class="fu">aes</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">t</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">X1</span>, <span class="kw">group</span><span class="kw">=</span> <span class="no">sim</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="no">sim</span>))) +
         <span class="fu">geom_line</span>() +
  <span class="fu">labs</span>(<span class="kw">x</span> <span class="kw">=</span> <span class="st">"time"</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="st">"Number of infectious"</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="st">"Sim."</span>)</pre></body></html></div>
<p><img src="basic-abm_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<p>The strength of <code>simulate_agents</code> is that it can simulate an outbreak for <strong>any</strong> valid input of <span class="math inline">\(D\)</span>.</p>
</div>
<div id="a-cyclical-sir-model-sirs" class="section level2">
<h2 class="hasAnchor">
<a href="#a-cyclical-sir-model-sirs" class="anchor"></a>A cyclical SIR model (SIRS)</h2>
<p>In this model, a recovered individual does not acquire lifelong immunity. The ODEs we use are</p>
<p><span class="math display">\[
\frac{dS}{dt} = -\beta (t) \frac{SI}{N} + \eta R
\]</span></p>
<p><span class="math display">\[
\frac{dI}{dt} = \beta (t) \frac{SI}{N} - \gamma I
\]</span></p>
<p><span class="math display">\[
\frac{dR}{dt} = \gamma I - \eta R.
\]</span> where <span class="math inline">\(\beta(t) = b + sin(t)\)</span>, which allows for a cyclical infection rate.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="co">## SIRS</span>

<span class="co">## This is the SIRS representation</span>
<span class="no">trans_mat</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"X0 * (1 - X1 * (par1  +  sin(t)) / N)"</span>, <span class="st">"X0 * X1  * (par1 + sin(t)) / N"</span>, <span class="st">"0"</span>,
                  <span class="st">"0"</span>, <span class="st">"X1 * (1 - par2)"</span>, <span class="st">"par2 * X1"</span>,
                  <span class="st">"X2 * par3"</span>, <span class="st">"0"</span>, <span class="st">"X2 * (1 - par3)"</span>), <span class="kw">byrow</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">nrow</span> <span class="kw">=</span> <span class="fl">3</span>)
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="no">trans_mat</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"S"</span>, <span class="st">"I"</span>, <span class="st">"R"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">trans_mat</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"S"</span>, <span class="st">"I"</span>, <span class="st">"R"</span>)
<span class="no">init_vals</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">950</span>, <span class="fl">50</span>, <span class="fl">0</span>)
<span class="no">par_vals</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw">par1</span> <span class="kw">=</span> <span class="fl">.5</span>, <span class="kw">par2</span> <span class="kw">=</span> <span class="fl">.25</span>, <span class="kw">par3</span> <span class="kw">=</span> <span class="fl">.05</span>)
<span class="no">max_T</span> <span class="kw">&lt;-</span> <span class="fl">100</span>
<span class="no">n_sims</span> <span class="kw">&lt;-</span> <span class="fl">100</span>


<span class="co">## Print the transition matrix</span>
<span class="fu">kable</span>(<span class="no">trans_mat</span>) <span class="kw">%&gt;%</span> <span class="fu">kable_styling</span>(<span class="kw">positio</span> <span class="kw">=</span> <span class="st">"center"</span>)</pre></body></html></div>
<table class="table table">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
S
</th>
<th style="text-align:left;">
I
</th>
<th style="text-align:left;">
R
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
S
</td>
<td style="text-align:left;">
X0 * (1 - X1 * (par1 + sin(t)) / N)
</td>
<td style="text-align:left;">
X0 * X1 * (par1 + sin(t)) / N
</td>
<td style="text-align:left;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
I
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
X1 * (1 - par2)
</td>
<td style="text-align:left;">
par2 * X1
</td>
</tr>
<tr>
<td style="text-align:left;">
R
</td>
<td style="text-align:left;">
X2 * par3
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
X2 * (1 - par3)
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="co">## Warning:  will take about a minute.  Set `verbose = TRUE` to see progress</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">2020</span>)
<span class="no">abm</span> <span class="kw">&lt;-</span> <span class="fu">simulate_agents</span>(<span class="no">trans_mat</span>,
                       <span class="no">init_vals</span>,
                       <span class="no">par_vals</span>,
                       <span class="no">max_T</span>,
                       <span class="no">n_sims</span>,
                       <span class="kw">verbose</span> <span class="kw">=</span> <span class="fl">FALSE</span>,
                       <span class="kw">out_format</span> <span class="kw">=</span> <span class="st">"long"</span>)

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">abm</span>) <span class="kw">%&gt;%</span>
  <span class="fu">kable</span>() <span class="kw">%&gt;%</span> <span class="fu">kable_styling</span>(<span class="kw">position</span> <span class="kw">=</span> <span class="st">"center"</span>)</pre></body></html></div>
<table class="table table">
<thead><tr>
<th style="text-align:right;">
sim
</th>
<th style="text-align:right;">
agent_id
</th>
<th style="text-align:right;">
time
</th>
<th style="text-align:right;">
state
</th>
<th style="text-align:left;">
state_name
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
S
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
I
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
R
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
S
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
85
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
I
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
88
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
R
</td>
</tr>
</tbody>
</table>
<p>In the above table, it is clear that the agent can become susceptible again.</p>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references hanging-indent">
<div id="ref-jeness2018-epimodel">
<p>Jenness, Samuel, Steven Goodreau, and Martina Morris. 2018. “EpiModel: An R Package for Mathematical Modeling of Infectious Disease over Networks.” <em>Journal of Statistical Software, Articles</em> 84 (8): 1–47. <a href="https://doi.org/10.18637/jss.v084.i08">https://doi.org/10.18637/jss.v084.i08</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://skgallagher.github.io/">Shannon Gallagher</a>, <a href="https://benjaminleroy.github.io/">Benjamin LeRoy</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
