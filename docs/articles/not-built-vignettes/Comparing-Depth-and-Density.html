<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Comparing Depth and Density • EpiCompare</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><meta property="og:title" content="Comparing Depth and Density">
<meta property="og:description" content="EpiCompare">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">EpiCompare</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/not-built-vignettes/hagelloch-eda.html">Hagelloch Measles -- Pre-processing and EDA</a>
    </li>
    <li>
      <a href="../../articles/getting-started.html">Getting started</a>
    </li>
    <li>
      <a href="../../articles/not-built-vignettes/ternary-plots-explained.html">An Introduction to Ternary Plots</a>
    </li>
    <li>
      <a href="../../articles/not-built-vignettes/comparing-bands-and-assessing-containment.html">Comparing Models (to Models) and Epidemics (to Models)</a>
    </li>
    <li>
      <a href="../../articles/not-built-vignettes/depths-impact-on-prediction-bands.html">Understanding Prediction Bands and the Impact of Quantile Functions</a>
    </li>
    <li>
      <a href="../../articles/not-built-vignettes/example-epimodel.html">Using EpiModel models with EpiCompare</a>
    </li>
    <li>
      <a href="../../articles/not-built-vignettes/basic-abm.html">Basic simulations with EpiCompare</a>
    </li>
    <li class="divider">
    <li>
      <a href="../../articles/index.html">More...</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/skgallagher/EpiCompare/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Comparing-Depth-and-Density_files/header-attrs-2.2/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Comparing Depth and Density</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/skgallagher/EpiCompare/blob/master/vignettes/not-built-vignettes/Comparing-Depth-and-Density.Rmd"><code>vignettes/not-built-vignettes/Comparing-Depth-and-Density.Rmd</code></a></small>
      <div class="hidden name"><code>Comparing-Depth-and-Density.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true"></a><span class="im">import</span> scipy.stats</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true"></a><span class="im">import</span> scipy</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true"></a><span class="im">import</span> scipy.spatial</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true"></a><span class="im">import</span> progressbar</span></code></pre></div>
<div id="the-difference-between-density-and-depth" class="section level1">
<h1 class="hasAnchor">
<a href="#the-difference-between-density-and-depth" class="anchor"></a>The difference between density and depth</h1>
<p>In this vignette, we will be attempting to compare depth (distance based) to a Guassian KDE - to emphasis that depth (local or otherwise) focuses more on geometric features of centrality than kernel density destimates. This will be done using data in 1d and 2d euclidean space.</p>
<p>We will be using 2 different data sets, as show below and have versions of them in 1d and 2d euclidean space.</p>
<p><em>This vignette is actually written in <code>python</code> using the <code>reticulate</code> package from <code>R studio</code>. This was done for some speed gains. It’s possible that we will craft this into a fast <code>R</code> approach later in this package’s life.</em></p>
<div id="the-data" class="section level2">
<h2 class="hasAnchor">
<a href="#the-data" class="anchor"></a>the data</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true"></a>np.random.seed(<span class="dv">1</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true"></a>single_2d <span class="op">=</span> np.random.uniform(size <span class="op">=</span> (<span class="dv">1000</span>,<span class="dv">2</span>))</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true"></a>single_1d <span class="op">=</span> np.random.uniform(size <span class="op">=</span> <span class="dv">1000</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true"></a>double_2d <span class="op">=</span> np.vstack([</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true"></a>              np.vstack([np.random.uniform(low <span class="op">=</span> <span class="dv">0</span>, high <span class="op">=</span> <span class="fl">.1</span>,size <span class="op">=</span> (<span class="dv">500</span>)),</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true"></a>                         np.random.uniform(low <span class="op">=</span> <span class="dv">0</span>, high <span class="op">=</span> <span class="dv">1</span>,size <span class="op">=</span> (<span class="dv">500</span>))]).T,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true"></a>              np.vstack([np.random.uniform(low <span class="op">=</span> <span class="fl">.9</span>, high <span class="op">=</span> <span class="dv">1</span>,size <span class="op">=</span> (<span class="dv">500</span>)),</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true"></a>                         np.random.uniform(low <span class="op">=</span> <span class="dv">0</span>, high <span class="op">=</span> <span class="dv">1</span>,size <span class="op">=</span> (<span class="dv">500</span>))]).T])</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true"></a>double_1d <span class="op">=</span> np.hstack([np.random.uniform(low <span class="op">=</span> <span class="dv">0</span>, high <span class="op">=</span> <span class="fl">.1</span>,size <span class="op">=</span> (<span class="dv">500</span>)),</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true"></a>                       np.random.uniform(low <span class="op">=</span> <span class="fl">.9</span>, high <span class="op">=</span> <span class="dv">1</span>,size <span class="op">=</span> (<span class="dv">500</span>))])</span></code></pre></div>
<p><img src="Comparing-Depth-and-Density_files/figure-html/unnamed-chunk-5-1.png"><!-- --></p>
</div>
<div id="d-data-example" class="section level2">
<h2 class="hasAnchor">
<a href="#d-data-example" class="anchor"></a>2d data example</h2>
<p>Let’s first do the 2d data examples (I think they’re really good at emphasising the differences between the two). As you can see from the data visualization</p>
<div id="block-distribution" class="section level3">
<h3 class="hasAnchor">
<a href="#block-distribution" class="anchor"></a>1 block distribution</h3>
<p>Let’s start with the 2d euclidean data first. For the 1 block of uniform distribution, we will examine different values of <span class="math inline">\(\tau\)</span> relative to the local distance depth defined above.</p>
<p><strong>But before we do</strong>, let’s look at the distribution to distances:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true"></a>dist_mat <span class="op">=</span> scipy.spatial.distance_matrix(x <span class="op">=</span> single_2d, y <span class="op">=</span> single_2d)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true"></a>plt.hist(dist_mat.ravel())<span class="op">;</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true"></a>plt.show()</span></code></pre></div>
<p><img src="Comparing-Depth-and-Density_files/figure-html/unnamed-chunk-6-1.png"><!-- --></p>
<div id="local-depth-and-global-depth" class="section level4">
<h4 class="hasAnchor">
<a href="#local-depth-and-global-depth" class="anchor"></a>Local Depth and Global Depth</h4>
<p>I’ve hidden the creation of a python version of <code><a href="../../reference/local_distance_depth_function.html">EpiCompare::local_distance_depth_function</a></code> in this document, but it’s coded the same way - just a little faster in <code>python</code> than <code>R</code>.</p>
<p>Below are visualization of the different local depth scores (relative to <span class="math inline">\(\tau\)</span>).</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true"></a>tau_list <span class="op">=</span> [<span class="fl">.1</span>,<span class="fl">.2</span>,<span class="fl">.4</span>,<span class="fl">.6</span>,<span class="fl">.8</span>,<span class="dv">1</span>,np.inf]</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true"></a>bar <span class="op">=</span> progressbar.ProgressBar()</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true"></a>ldd <span class="op">=</span> <span class="bu">list</span>()</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true"></a><span class="cf">for</span> tau <span class="kw">in</span> bar(tau_list):</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true"></a>    ldd.append(local_distance_depth_function(dist_mat, tau))</span></code></pre></div>
<pre><code>##   0% |                                                                                    |
 14% |############                                                                        |
 28% |########################                                                            |
 42% |####################################                                                |
 57% |################################################                                    |
 71% |############################################################                        |
 85% |########################################################################            |
100% |####################################################################################|</code></pre>
<p><img src="Comparing-Depth-and-Density_files/figure-html/unnamed-chunk-10-1.png"><!-- --></p>
<p>We really want to compare this to smoothing of a Guassian KDE to be able to really examine the differences.</p>
</div>
<div id="kde-estimate" class="section level4">
<h4 class="hasAnchor">
<a href="#kde-estimate" class="anchor"></a>KDE Estimate</h4>
<p>The below estimates are with varying bandwidth parameters for the Guassian KDE estimates. Note that the final “bw = silverman” uses the Silverman’s Method to select the bandwidth parameter.</p>
<p><img src="Comparing-Depth-and-Density_files/figure-html/unnamed-chunk-12-1.png"><!-- --></p>
</div>
<div id="comparing-the-differences" class="section level4">
<h4 class="hasAnchor">
<a href="#comparing-the-differences" class="anchor"></a>Comparing the Differences</h4>
<p>It should be pretty clear these two approaches act differently. And, with the uniform structure we capture different things. Arguably the depth approach better captures the geometric structure of the uniform distribution. You can image a Gaussian distribution (instead of uniform distribution), would show much less differences.</p>
<p>Let’s move onto another two-dimensional dataset that has different, but also interesting, structure - 2 disjoint uniform blocks.</p>
</div>
</div>
<div id="block-distribution-1" class="section level3">
<h3 class="hasAnchor">
<a href="#block-distribution-1" class="anchor"></a>2 block distribution</h3>
<p>Again, let’s first look at the distribution of distances between data points. <img src="Comparing-Depth-and-Density_files/figure-html/unnamed-chunk-13-1.png"><!-- --></p>
<div id="local-depth-and-global-depth-1" class="section level4">
<h4 class="hasAnchor">
<a href="#local-depth-and-global-depth-1" class="anchor"></a>Local Depth and Global Depth</h4>
<div class="sourceCode" id="cb6"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true"></a>tau_list2 <span class="op">=</span> [<span class="fl">.1</span>,<span class="fl">.2</span>,<span class="fl">.4</span>,<span class="fl">.6</span>,<span class="fl">.8</span>,<span class="dv">1</span>,<span class="fl">1.2</span>,np.inf]</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true"></a>bar <span class="op">=</span> progressbar.ProgressBar()</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true"></a>ldd2 <span class="op">=</span> <span class="bu">list</span>()</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true"></a><span class="cf">for</span> tau <span class="kw">in</span> bar(tau_list2):</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true"></a>    ldd2.append(local_distance_depth_function(dist_mat2, tau))</span></code></pre></div>
<pre><code>##   0% |                                                                                    |
 12% |##########                                                                          |
 25% |#####################                                                               |
 37% |###############################                                                     |
 50% |##########################################                                          |
 62% |####################################################                                |
 75% |###############################################################                     |
 87% |#########################################################################           |
100% |####################################################################################|</code></pre>
<p><img src="Comparing-Depth-and-Density_files/figure-html/unnamed-chunk-16-1.png"><!-- --></p>
</div>
<div id="kde" class="section level4">
<h4 class="hasAnchor">
<a href="#kde" class="anchor"></a>KDE</h4>
<p><img src="Comparing-Depth-and-Density_files/figure-html/unnamed-chunk-18-1.png"><!-- --></p>
</div>
<div id="comparisons" class="section level4">
<h4 class="hasAnchor">
<a href="#comparisons" class="anchor"></a>Comparisons</h4>
<p>In this example too, the geometric structure of the data is more highlighted with the low values of <span class="math inline">\(\tau\)</span> - in which we get a central ridge for each of the blocks. This isn’t captured by the KDE, and we get (do to random clumping) high density regions that <em>do not</em> well represent the geometric structure of the data.</p>
</div>
</div>
</div>
<div id="d-data-example-1" class="section level2">
<h2 class="hasAnchor">
<a href="#d-data-example-1" class="anchor"></a>1d data example</h2>
<p>Below I’d just like to show the same argumet in the <code>x</code> dimension of the data. I’ll just be showing the figures</p>
<div id="block-distribution-2" class="section level3">
<h3 class="hasAnchor">
<a href="#block-distribution-2" class="anchor"></a>1 Block distribution</h3>
<p>Let’s start with the 2d euclidean data first. For the 1 block of uniform distribution, we will examine different values of <span class="math inline">\(\tau\)</span> relative to the local distance depth defined above.</p>
<p><strong>But before we do</strong>, let’s look at the distribution to distances:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true"></a>dist_mat <span class="op">=</span> scipy.spatial.distance_matrix(x <span class="op">=</span> single_1d.reshape((<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)), y <span class="op">=</span> single_1d.reshape((<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)))</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true"></a>plt.hist(dist_mat.ravel())<span class="op">;</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true"></a>plt.show()</span></code></pre></div>
<p><img src="Comparing-Depth-and-Density_files/figure-html/unnamed-chunk-19-1.png"><!-- --></p>
<div id="local-depth-and-global-depth-2" class="section level4">
<h4 class="hasAnchor">
<a href="#local-depth-and-global-depth-2" class="anchor"></a>Local Depth and Global Depth</h4>
<div class="sourceCode" id="cb9"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true"></a>tau_list <span class="op">=</span> [<span class="fl">.1</span>,<span class="fl">.2</span>,<span class="fl">.4</span>,<span class="fl">.6</span>,<span class="fl">.8</span>,np.inf]</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true"></a>bar <span class="op">=</span> progressbar.ProgressBar()</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true"></a>ldd <span class="op">=</span> <span class="bu">list</span>()</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true"></a><span class="cf">for</span> tau <span class="kw">in</span> bar(tau_list):</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true"></a>    ldd.append(local_distance_depth_function(dist_mat, tau))</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true"></a><span class="co"># get min/max range of density estimate:</span></span></code></pre></div>
<pre><code>##   0% |                                                                        |
 16% |############                                                            |
 33% |########################                                                |
 50% |####################################                                    |
 66% |################################################                        |
 83% |############################################################            |
100% |########################################################################|</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true"></a>_min <span class="op">=</span> np.inf</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true"></a>_max <span class="op">=</span> <span class="op">-</span>np.inf</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true"></a><span class="cf">for</span> idx, tau <span class="kw">in</span> <span class="bu">enumerate</span>(tau_list):</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true"></a>    _min <span class="op">=</span> np.<span class="bu">min</span>([np.<span class="bu">min</span>(ldd[idx]), _min])</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true"></a>    _max <span class="op">=</span> np.<span class="bu">max</span>([np.<span class="bu">max</span>(ldd[idx]), _max])</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true"></a><span class="co">#visualizing them</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true"></a>fig, ax <span class="op">=</span> plt.subplots(nrows <span class="op">=</span> <span class="dv">2</span>, ncols <span class="op">=</span> <span class="dv">4</span>, figsize <span class="op">=</span> (<span class="dv">12</span>,<span class="dv">6</span>))</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true"></a>ax <span class="op">=</span> ax.ravel()</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true"></a></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true"></a><span class="cf">for</span> idx, tau <span class="kw">in</span> <span class="bu">enumerate</span>(tau_list):</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true"></a>    ldd_tau_i <span class="op">=</span> ldd[idx]</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true"></a>    resort <span class="op">=</span> np.argsort(single_1d)</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true"></a>    cs <span class="op">=</span> ax[idx].plot(single_1d[resort],  </span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true"></a>                      ldd_tau_i[resort])</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true"></a>    ax[idx].set_title(<span class="st">"tau = "</span> <span class="op">+</span> <span class="bu">str</span>(tau))<span class="op">;</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true"></a></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true"></a></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true"></a>fig.delaxes(ax[<span class="dv">7</span>])<span class="op">;</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true"></a>fig.suptitle(<span class="st">"Local Depth fitting on uniform hypercube"</span>)<span class="op">;</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true"></a>fig.tight_layout(rect<span class="op">=</span>[<span class="dv">0</span>, <span class="fl">0.03</span>, <span class="dv">1</span>, <span class="fl">0.95</span>])<span class="op">;</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true"></a>plt.show()</span></code></pre></div>
<p><img src="Comparing-Depth-and-Density_files/figure-html/unnamed-chunk-20-1.png"><!-- --></p>
</div>
<div id="kde-estimate-1" class="section level4">
<h4 class="hasAnchor">
<a href="#kde-estimate-1" class="anchor"></a>KDE Estimate</h4>
<p><img src="Comparing-Depth-and-Density_files/figure-html/unnamed-chunk-21-1.png"><!-- --></p>
</div>
</div>
<div id="block-distribution-3" class="section level3">
<h3 class="hasAnchor">
<a href="#block-distribution-3" class="anchor"></a>2 Block distribution</h3>
<p>I’m not sure that this really shows anything, but I include it anyway.</p>
<p>Let’s look at the distribution to distances, for the 2 block distribution</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true"></a>dist_mat <span class="op">=</span> scipy.spatial.distance_matrix(x <span class="op">=</span> double_1d.reshape((<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)), y <span class="op">=</span> double_1d.reshape((<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)))</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true"></a>plt.hist(dist_mat.ravel(),bins <span class="op">=</span> <span class="dv">50</span>)<span class="op">;</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true"></a>plt.show()</span></code></pre></div>
<p><img src="Comparing-Depth-and-Density_files/figure-html/unnamed-chunk-22-1.png"><!-- --></p>
<div id="local-depth-and-global-depth-3" class="section level4">
<h4 class="hasAnchor">
<a href="#local-depth-and-global-depth-3" class="anchor"></a>Local Depth and Global Depth</h4>
<div class="sourceCode" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true"></a>tau_list <span class="op">=</span> [<span class="fl">.1</span>,<span class="fl">.2</span>,<span class="fl">.4</span>,<span class="fl">.6</span>,<span class="fl">.8</span>,np.inf]</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true"></a>bar <span class="op">=</span> progressbar.ProgressBar()</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true"></a>ldd <span class="op">=</span> <span class="bu">list</span>()</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true"></a><span class="cf">for</span> tau <span class="kw">in</span> bar(tau_list):</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true"></a>    ldd.append(local_distance_depth_function(dist_mat, tau))</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true"></a><span class="co"># get min/max range of density estimate:</span></span></code></pre></div>
<pre><code>##   0% |                                                                                    |
 16% |##############                                                                      |
 33% |############################                                                        |
 50% |##########################################                                          |
 66% |########################################################                            |
 83% |######################################################################              |
100% |####################################################################################|</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true"></a>_min <span class="op">=</span> np.inf</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true"></a>_max <span class="op">=</span> <span class="op">-</span>np.inf</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true"></a><span class="cf">for</span> idx, tau <span class="kw">in</span> <span class="bu">enumerate</span>(tau_list):</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true"></a>    _min <span class="op">=</span> np.<span class="bu">min</span>([np.<span class="bu">min</span>(ldd[idx]), _min])</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true"></a>    _max <span class="op">=</span> np.<span class="bu">max</span>([np.<span class="bu">max</span>(ldd[idx]), _max])</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true"></a><span class="co">#visualizing them</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true"></a>fig, ax <span class="op">=</span> plt.subplots(nrows <span class="op">=</span> <span class="dv">2</span>, ncols <span class="op">=</span> <span class="dv">4</span>, figsize <span class="op">=</span> (<span class="dv">12</span>,<span class="dv">6</span>))</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true"></a>ax <span class="op">=</span> ax.ravel()</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true"></a><span class="cf">for</span> idx, tau <span class="kw">in</span> <span class="bu">enumerate</span>(tau_list):</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true"></a>    ldd_tau_i <span class="op">=</span> ldd[idx]</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true"></a>    resort <span class="op">=</span> np.argsort(double_1d)</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true"></a>    cs <span class="op">=</span> ax[idx].plot(double_1d[resort],  </span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true"></a>                      ldd_tau_i[resort])</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true"></a>    ax[idx].set_title(<span class="st">"tau = "</span> <span class="op">+</span> <span class="bu">str</span>(tau))<span class="op">;</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true"></a></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true"></a></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true"></a>fig.delaxes(ax[<span class="dv">7</span>])<span class="op">;</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true"></a>fig.suptitle(<span class="st">"Local Depth fitting on uniform hypercube"</span>)<span class="op">;</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true"></a>fig.tight_layout(rect<span class="op">=</span>[<span class="dv">0</span>, <span class="fl">0.03</span>, <span class="dv">1</span>, <span class="fl">0.95</span>])<span class="op">;</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true"></a>plt.show()</span></code></pre></div>
<p><img src="Comparing-Depth-and-Density_files/figure-html/unnamed-chunk-23-1.png"><!-- --></p>
</div>
<div id="kde-estimate-2" class="section level4">
<h4 class="hasAnchor">
<a href="#kde-estimate-2" class="anchor"></a>KDE Estimate</h4>
<pre><code>## KernelDensity(bandwidth=0.01)
## KernelDensity(bandwidth=0.05)
## KernelDensity(bandwidth=0.1)
## KernelDensity(bandwidth=0.2)
## KernelDensity(bandwidth=0.3)
## KernelDensity(bandwidth=0.5)
## KernelDensity(bandwidth=1)</code></pre>
<p><img src="Comparing-Depth-and-Density_files/figure-html/unnamed-chunk-24-1.png"><!-- --></p>
</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://skgallagher.github.io/">Shannon Gallagher</a>, <a href="https://benjaminleroy.github.io/">Benjamin LeRoy</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
